<!DOCTYPE html>
<html>
<head>
  <title>My Published Google Sheet</title>
  <script src="https://unpkg.com/tabletop@1.6.0/tabletop.js"></script>
  <style>
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    th { background-color: #f2f2f2; }
  </style>
</head>
<body>
  <h2>Google Sheet Data</h2>
  <table id="sheetTable"></table>

  <script>
    const publicSpreadsheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTzNKwzC3WQdytWJ2-dYnBGQqDyUTgB5kKhFux-ToCGSiLWT0ApsIeuTOoiVFUU0D63LDMdU4I2uzwO/pubhtml?gid=0&single=trueâ€™;

    function init() {
      Tabletop.init({
        key: publicSpreadsheetUrl,
        callback: showInfo,
        simpleSheet: true
      });
    }

    function showInfo(data) {
      const table = document.getElementById("sheetTable");
      if (data.length === 0) {
        table.innerHTML = "<tr><td>No data found</td></tr>";
        return;
      }

      // Add table headers
      let headerRow = "<tr>";
      Object.keys(data[0]).forEach(key => {
        headerRow += `<th>${key}</th>`;
      });
      headerRow += "</tr>";
      table.innerHTML += headerRow;

      // Add table rows
      data.forEach(row => {
        let rowHTML = "<tr>";
        Object.values(row).forEach(cell => {
          rowHTML += `<td>${cell}</td>`;
        });
        rowHTML += "</tr>";
        table.innerHTML += rowHTML;
      });
    }

    window.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
